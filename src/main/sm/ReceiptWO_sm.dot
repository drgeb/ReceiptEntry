digraph ReceiptWO {

    node
        [shape=Mrecord width=1.5];

    subgraph cluster_MainMap {

        label="MainMap";

        //
        // States (Nodes)
        //

        "MainMap::Created"
            [label="{Created}"];

        "MainMap::CheckingCredit"
            [label="{CheckingCredit}"];

        "MainMap::Filled"
            [label="{Filled}"];

        "MainMap::Shipped"
            [label="{Shipped}"];

        "%start"
            [label="" shape=circle style=filled fillcolor=black width=0.25];

        //
        // Transitions (Edges)
        //

        "MainMap::Created" -> "MainMap::CheckingCredit"
            [label="submit/\lupdateState;\l"];

        "MainMap::Created" -> "MainMap::Created"
            [label="view/\lupdateState;\l"];

        "MainMap::CheckingCredit" -> "MainMap::Created"
            [label="reject\l\[				 		\l		  !ctxt.isCreditOK(ctxt.getReceipt())						\l		\]/\lnotifyCustomer;\lupdateState;\l"];

        "MainMap::CheckingCredit" -> "MainMap::Filled"
            [label="fill\l\[				 		\l		  ctxt.isCreditOK(ctxt.getReceipt())						\l		\]/\ldoFill;\lupdateState;\l"];

        "MainMap::Filled" -> "MainMap::Shipped"
            [label="ship/\lnotifyCustomer;\lupdateState;\l"];

        "%start" -> "MainMap::Created"
    }

}
